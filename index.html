<!doctype html>
<html lang="ja">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="ひらがな時計">
  <meta name="format-detection" content="telephone=no">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hiragana Clock</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#60a5fa;--muted:#94a3b8}
    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,\"Noto Sans JP\",\"Hiragino Kaku Gothic ProN\",sans-serif;background:linear-gradient(180deg,var(--bg),#071025);color:#e6eef8;overflow:hidden}
    .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:24px}
    .card{background:linear-gradient(180deg,var(--card),#07101a);padding:36px;border-radius:16px;box-shadow:0 10px 30px rgba(2,6,23,0.6);text-align:center;width:100%;max-width:420px;position:relative}
    .clock{font-size:110px;line-height:0.9;font-weight:700;letter-spacing:0.01em}
    .minutes{font-size:58px;margin-top:10px;opacity:0.95}
    .meta{margin-top:18px;color:var(--muted);text-align:left}
    .meta summary{cursor:pointer;list-style:none;font-size:14px;color:var(--muted)}
    .meta summary::marker{display:none}
    .meta details{margin-top:10px}
    .controls{display:flex;flex-direction:column;gap:8px;padding-top:8px}
    .btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 10px;border-radius:8px;color:inherit;cursor:pointer}
    .small{font-size:13px;color:var(--muted)}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

    @media (max-width:480px){
      .card{padding:20px;box-shadow:none;background:transparent}
      .clock{font-size:140px}
      .minutes{font-size:80px;margin-top:16px}
      details{position:absolute;bottom:16px;left:50%;transform:translateX(-50%);width:auto;text-align:center}
      summary{color:var(--muted);opacity:0.8;font-size:12px}
    }
  </style>
</head>
<body>
  <main class="wrap">
    <section class="card" aria-live="polite">
      <h1 class="sr-only">Hiragana Clock</h1>
      <div id="hour" class="clock">れい</div>
      <div id="minute" class="minutes">れい</div>

      <details class="meta">
        <summary>⚙️ Settings</summary>
        <div class="controls">
          <label class="small">
            <input id="toggle24" type="checkbox" /> 24-hour
          </label>
          <label class="small">
            <input id="withCounters" type="checkbox" /> show じ / ふん
          </label>
          <button id="copyBtn" class="btn small">Copy as text</button>
          <p class="small" style="margin-top:8px">This page converts the current time into hiragana words and updates in real time.</p>
        </div>
      </details>
    </section>
  </main>

  <script>
    const digits = {0:'れい',1:'いち',2:'に',3:'さん',4:'よん',5:'ご',6:'ろく',7:'なな',8:'はち',9:'きゅう'};
    const tensWord = {10:'じゅう',20:'にじゅう',30:'さんじゅう',40:'よんじゅう',50:'ごじゅう'};

    function numberToHiragana(n){
      n = Number(n);
      if (Number.isNaN(n) || n < 0) return '';
      if (n <= 9) return digits[n];
      if (n <= 19){
        if (n === 10) return 'じゅう';
        return 'じゅう' + digits[n - 10];
      }
      if (n <= 59){
        const tens = Math.floor(n / 10) * 10;
        const unit = n % 10;
        const tensPart = tensWord[tens] || (digits[Math.floor(n/10)] + 'じゅう');
        return unit === 0 ? tensPart : tensPart + digits[unit];
      }
      const parts = [];
      let remainder = n;
      if (remainder >= 100){
        const hundreds = Math.floor(remainder / 100);
        parts.push(digits[hundreds] + 'ひゃく');
        remainder = remainder % 100;
      }
      if (remainder > 0) parts.push(numberToHiragana(remainder));
      return parts.join('');
    }

    function displayTime(){
      const now = new Date();
      const use24 = document.getElementById('toggle24').checked;
      let hours = now.getHours();
      const minutes = now.getMinutes();
      let hourForDisplay = hours;
      if (!use24) {
        hourForDisplay = hours % 12;
        if (hourForDisplay === 0) hourForDisplay = 12;
      }
      const withCounters = document.getElementById('withCounters').checked;
      const hourText = numberToHiragana(hourForDisplay) || 'れい';
      const minuteText = numberToHiragana(minutes) || 'れい';
      const hourEl = document.getElementById('hour');
      const minuteEl = document.getElementById('minute');
      hourEl.textContent = withCounters ? (hourText + 'じ') : hourText;
      minuteEl.textContent = withCounters ? (minuteText + 'ふん') : minuteText;
      document.title = `Time — ${hourForDisplay}:${String(minutes).padStart(2,'0')}`;
    }

    displayTime();
    setInterval(displayTime, 1000);

    document.getElementById('copyBtn').addEventListener('click', async ()=>{
      const hour = document.getElementById('hour').textContent;
      const minute = document.getElementById('minute').textContent;
      const text = hour + '\n' + minute;
      try{
        await navigator.clipboard.writeText(text);
        document.getElementById('copyBtn').textContent = 'Copied!';
        setTimeout(()=>document.getElementById('copyBtn').textContent = 'Copy as text',1200);
      }catch(e){
        alert('Unable to copy — please select and copy manually.');
      }
    });

    document.getElementById('toggle24').addEventListener('change', displayTime);
    document.getElementById('withCounters').addEventListener('change', displayTime);
  </script>
</body>
</html>
